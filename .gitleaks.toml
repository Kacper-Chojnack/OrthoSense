title = "OrthoSense Secret Detection"

[extend]
useDefault = true

[allowlist]
description = "Global allowlist"

# Historical commits with expired/rotated secrets (safe to ignore)
commits = [
    "813cc314c139d1e7cbdf8f3485660b144ad60847",  # Old dev secrets.tfvars (rotated)
    "d827e79d5a8dec596382d40cc45d9d6653033f22",  # Old .env with test tokens (rotated)
]

paths = [
    '''\.git''',
    '''node_modules''',
    '''\.venv''',
    '''venv''',
    '''build''',
    '''\.dart_tool''',
    '''\.pub-cache''',
    # Test files with fake secrets
    '''backend/tests/.*''',
    '''test/.*''',
    # Lock files
    '''pubspec\.lock''',
    '''poetry\.lock''',
    # Example env files (contain placeholders, not real secrets)
    '''\.env\.example''',
]

regexTarget = "match"

[[rules]]
id = "orthosense-api-key"
description = "OrthoSense API Key"
regex = '''orthosense[_-]?api[_-]?key['\"]?\s*[:=]\s*['\"]?([a-zA-Z0-9_-]{20,})'''
secretGroup = 1

[[rules]]
id = "database-url-with-password"
description = "Database Connection String with Password"
regex = '''(?i)(postgres|mysql|mongodb|redis):\/\/[^:]+:[^@]+@[^\s'"]+'''

[[rules]]
id = "jwt-secret-key"
description = "JWT Secret Key"
regex = '''(?i)(jwt[_-]?secret|secret[_-]?key)['\"]?\s*[:=]\s*['\"]?([a-zA-Z0-9!@#$%^&*()_+-=]{32,})'''
secretGroup = 2

[[rules]]
id = "aws-access-key"
description = "AWS Access Key ID"
regex = '''(?i)aws[_-]?access[_-]?key[_-]?id['\"]?\s*[:=]\s*['\"]?(AKIA[0-9A-Z]{16})'''
secretGroup = 1

[[rules]]
id = "aws-secret-key"
description = "AWS Secret Access Key"
regex = '''(?i)aws[_-]?secret[_-]?access[_-]?key['\"]?\s*[:=]\s*['\"]?([a-zA-Z0-9/+=]{40})'''
secretGroup = 1

[rules.allowlist]
regexes = [
    '''change-this-to-a-secure-random-string''',
    '''test[_-]secret[_-]key''',
    '''e2e[_-]test[_-]secret''',
    '''dev-secret-key''',
    '''example\.com''',
    '''localhost''',
    '''your-secret-key-here''',
    '''test_secret_key_for_.*''',
    '''SecureTestPass123!''',
    '''securePass.*''',
    '''testpass.*''',
]
